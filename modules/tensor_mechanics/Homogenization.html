<!DOCTYPE html><head><meta charset="UTF-8"><title>Imposing Average Homogenization Constraints with the Lagrangian Kernels | Chamois</title><link rel="icon" type="image/x-icon" href="../../media/chamois_logo.png" sizes="16x16 32x32 64x64 128x128"></link><link href="../../contrib/materialize/materialize.min.css" type="text/css" rel="stylesheet" media="screen,projection"></link><link href="../../contrib/prism/prism.min.css" type="text/css" rel="stylesheet"></link><link href="../../css/moose.css" type="text/css" rel="stylesheet"></link><link href="../../css/devel_moose.css" type="text/css" rel="stylesheet"></link><link href="../../css/alert_moose.css" type="text/css" rel="stylesheet"></link><link href="../../css/content_moose.css" type="text/css" rel="stylesheet"></link><link href="../../css/sqa_moose.css" type="text/css" rel="stylesheet"></link><link href="../../css/civet_moose.css" type="text/css" rel="stylesheet"></link><link href="../../contrib/katex/katex.min.css" type="text/css" rel="stylesheet"></link><link href="../../css/katex_moose.css" type="text/css" rel="stylesheet"></link><script type="text/javascript" src="../../contrib/jquery/jquery.min.js"></script><script type="text/javascript" src="../../contrib/katex/katex.min.js"></script></head><body><div class="page-wrap"><header><nav><div class="nav-wrapper container"><a href="../../index.html" class="left moose-logo hide-on-med-and-down" id="home-button">Chamois</a><a href="https://github.com/matthiasneuner/chamois" class="right"><img src="../../media/framework/github-logo.png" class="github-mark"></img><img src="../../media/framework/github-mark.png" class="github-logo"></img></a><ul class="right hide-on-med-and-down"><li><a href="../../getting_started.html">Getting Started</a></li><li><a href="../../singularity.html">Singularity container</a></li><li><a href="../../publications.html">Publications</a></li><li><a href="../../contributors.html">Contributors</a></li><li><a href="#!" class="dropdown-trigger" data-target="9505fc0f-ee54-4ff0-9047-872875b7e5ba" data-constrainWidth="false">Documentation<i class="material-icons right">arrow_drop_down</i></a></li></ul><a href="#" class="sidenav-trigger" data-target="fda2b6d2-1ce4-4c05-9e1d-13af12b4c2a2"><i class="material-icons">menu</i></a><ul class="sidenav" id="fda2b6d2-1ce4-4c05-9e1d-13af12b4c2a2"><li><a href="../../getting_started.html">Getting Started</a></li><li><a href="../../singularity.html">Singularity container</a></li><li><a href="../../publications.html">Publications</a></li><li><a href="../../contributors.html">Contributors</a></li><li><a href="#!" class="dropdown-trigger" data-target="d0e49b28-3b95-4536-991f-fb62509f410b" data-constrainWidth="false">Documentation<i class="material-icons right">arrow_drop_down</i></a></li></ul><a href="#moose-search" class="modal-trigger"><i class="material-icons">search</i></a></div><ul class="dropdown-content" id="9505fc0f-ee54-4ff0-9047-872875b7e5ba"><li><a href="../../syntax/chamois.html">Chamois syntax</a></li></ul><ul class="dropdown-content" id="d0e49b28-3b95-4536-991f-fb62509f410b"><li><a href="../../syntax/chamois.html">Chamois syntax</a></li></ul></nav><div class="modal modal-fixed-footer moose-search-modal" id="moose-search"><div class="modal-content container moose-search-modal-content"><div class="row"><div class="col l12"><div class="input-field"><input type_="text" onkeyup="mooseSearch()" placeholder="/index.md" id="moose-search-box"></input></div></div><div><div class="col s12" id="moose-search-results"></div></div></div></div><div class="modal-footer"><a href="#!" class="modal-close btn-flat">Close</a></div></div></header><main class="main"><div class="container"><div class="row"><div class="moose-content col s12 m12 l12"><section id="c05ec533-4302-42a3-80c9-6576ed6ea12d" data-section-level="1" data-section-text="Imposing Average Homogenization Constraints with the Lagrangian Kernels"><h1 id="imposing-average-homogenization-constraints-with-the-lagrangian-kernels">Imposing Average Homogenization Constraints with the Lagrangian Kernels</h1><section id="886dd4cb-ded5-4aee-aab9-6c79f708c268" data-section-level="2" data-section-text="Purpose of the Homogenization System"><h2 id="purpose-of-the-homogenization-system">Purpose of the Homogenization System</h2><p>The homogenization system is a means to impose cell-average stress or strain conditions on periodic unit cell models using the <a href="LagrangianKernelTheory.html">new, Lagrangian kernels</a> and specifically the <a href="../../source/kernels/lagrangian/TotalLagrangianStressDivergence.html">total Lagrangian</a> formulation. These types of constraints are very useful for homogenization simulations trying to determine the effective mechanical properties of a representative volume of material.</p></section><section id="54a53390-76c2-4920-906d-9bf4c4ca912b" data-section-level="2" data-section-text="Mathematical Description"><h2 id="mathematical-description">Mathematical Description</h2><p><a href="#danielsson2002three">Danielsson et al. (2002)</a> describes the theory underlying the  homogenization system.  The system aims to impose cell average  stress or deformation constraints.   For small deformations these constraints are of the type <span class="moose-katex-block-equation"><span class="moose-katex-equation table-cell" id="moose-equation-4949d656-8cc6-46d8-8882-de971dd775c0"></span><script>var element = document.getElementById("moose-equation-4949d656-8cc6-46d8-8882-de971dd775c0");katex.render("      \\hat{s}_{ij}=\\frac{1}{V}\\int_{v}s_{ij}dV", element, {displayMode:true,throwOnError:false});</script></span> or <span class="moose-katex-block-equation"><span class="moose-katex-equation table-cell" id="moose-equation-5889b120-df45-4e59-a2ae-dff9d120c18c"></span><script>var element = document.getElementById("moose-equation-5889b120-df45-4e59-a2ae-dff9d120c18c");katex.render("      \\hat{\\varepsilon}_{ij}=\\frac{1}{V}\\int_{V}\\varepsilon_{ij}dV", element, {displayMode:true,throwOnError:false});</script></span> and for large deformations the constraint options are: <span class="moose-katex-block-equation"><span class="moose-katex-equation table-cell" id="moose-equation-7ec31908-35e4-4480-91bc-113fb6827c8b"></span><script>var element = document.getElementById("moose-equation-7ec31908-35e4-4480-91bc-113fb6827c8b");katex.render("      \\hat{P}_{iJ}=\\frac{1}{V}\\int_{V}P_{iJ}dV", element, {displayMode:true,throwOnError:false});</script></span> or <span class="moose-katex-block-equation"><span class="moose-katex-equation table-cell" id="moose-equation-ca37b4b5-ea43-4ffe-844d-6b7a70612cfe"></span><script>var element = document.getElementById("moose-equation-ca37b4b5-ea43-4ffe-844d-6b7a70612cfe");katex.render("      \\hat{F}_{iJ}-\\delta_{iJ}=\\frac{1}{V}\\int_{V}\\left(F_{iJ}-\\delta_{iJ}\\right)dV.", element, {displayMode:true,throwOnError:false});</script></span> The &quot;hat&quot; quantities are targets set by the user with a MOOSE <a href="../../syntax/Functions/index.html">Function</a>. These targets control the cell-average stress or strain. For large deformations the system imposes the constraints on the 1st Piola-Kirchhoff stress or the displacement gradient. For small deformations the system constrains the small stress or the small strain. As with the underlying <a href="LagrangianKernelTheory.html">kernels</a>, the system uses the <code>large_kinematics</code> flag to switch between small and large deformation theory. Components can be mixed and matched &ndash; the system can impose deformation constraints in one tensor direction and stress constrains in the others. The number of available constraints varies by the problem dimension and the kinematic theory.  <a href="#sizes">Table 1</a> lists the available number of constraints and the order in which they appear when specified in the input file. The small kinematic theory admits fewer constraints because the relevant stress and strain tensors are symmetric. The small deformation constraints unroll following the Voigt convention, the large deformation constraints are the row-major unrolled full tensor</p><div class="card moose-float"><div class="card-content"><p class="moose-caption"><span class="moose-caption-heading">Table 1: </span><span class="moose-caption-text" id="sizes">Number of available constraints and input file order</span></p><div form="['center', 'center', 'center']" recursive class="moose-table-div"><table><thead><tr><th style=";text-align:center">Problem dimension</th><th style=";text-align:center">Small deformation constraints</th><th style=";text-align:center">Large deformation constraints</th></tr></thead><tbody><tr><td style=";text-align:center">1</td><td style=";text-align:center">1: <span class="moose-katex-inline-equation" id="moose-equation-ac46fbdf-7fe3-48c0-8ede-f19157b5e85c"><script>var element = document.getElementById("moose-equation-ac46fbdf-7fe3-48c0-8ede-f19157b5e85c");katex.render("xx", element, {displayMode:false,throwOnError:false});</script></span></td><td style=";text-align:center">1: <span class="moose-katex-inline-equation" id="moose-equation-9367dbe7-b09b-4be3-aa1f-5bcea35ff4fc"><script>var element = document.getElementById("moose-equation-9367dbe7-b09b-4be3-aa1f-5bcea35ff4fc");katex.render("xx", element, {displayMode:false,throwOnError:false});</script></span></td></tr></tbody><tbody><tr><td style=";text-align:center">2</td><td style=";text-align:center">3: <span class="moose-katex-inline-equation" id="moose-equation-44c4992d-9592-4c3c-bc83-2cf30c237f5a"><script>var element = document.getElementById("moose-equation-44c4992d-9592-4c3c-bc83-2cf30c237f5a");katex.render("xx", element, {displayMode:false,throwOnError:false});</script></span>, <span class="moose-katex-inline-equation" id="moose-equation-99dfc0c7-2f9b-4e37-b095-716611621536"><script>var element = document.getElementById("moose-equation-99dfc0c7-2f9b-4e37-b095-716611621536");katex.render("yy", element, {displayMode:false,throwOnError:false});</script></span>, <span class="moose-katex-inline-equation" id="moose-equation-ec07f659-b7b6-4cde-b388-4b686addc369"><script>var element = document.getElementById("moose-equation-ec07f659-b7b6-4cde-b388-4b686addc369");katex.render("xy", element, {displayMode:false,throwOnError:false});</script></span></td><td style=";text-align:center">4: <span class="moose-katex-inline-equation" id="moose-equation-2f6b3009-ce23-4952-9f51-12690c30b4a4"><script>var element = document.getElementById("moose-equation-2f6b3009-ce23-4952-9f51-12690c30b4a4");katex.render("xx", element, {displayMode:false,throwOnError:false});</script></span>, <span class="moose-katex-inline-equation" id="moose-equation-eb592bdc-6568-4ddd-ab67-41b8e83b0bc4"><script>var element = document.getElementById("moose-equation-eb592bdc-6568-4ddd-ab67-41b8e83b0bc4");katex.render("xy", element, {displayMode:false,throwOnError:false});</script></span>, <span class="moose-katex-inline-equation" id="moose-equation-2c9353e2-6125-4bb1-8a04-e86bc48eec0e"><script>var element = document.getElementById("moose-equation-2c9353e2-6125-4bb1-8a04-e86bc48eec0e");katex.render("yx", element, {displayMode:false,throwOnError:false});</script></span>, <span class="moose-katex-inline-equation" id="moose-equation-2ad47173-cdbd-48d0-9491-d133d11fe56a"><script>var element = document.getElementById("moose-equation-2ad47173-cdbd-48d0-9491-d133d11fe56a");katex.render("yy", element, {displayMode:false,throwOnError:false});</script></span></td></tr></tbody><tbody><tr><td style=";text-align:center">3</td><td style=";text-align:center">6: <span class="moose-katex-inline-equation" id="moose-equation-389abb20-5a9c-4f91-b593-66066a5bb183"><script>var element = document.getElementById("moose-equation-389abb20-5a9c-4f91-b593-66066a5bb183");katex.render("xx", element, {displayMode:false,throwOnError:false});</script></span>, <span class="moose-katex-inline-equation" id="moose-equation-348a3f02-4ef6-47c8-b7e7-a40622af7425"><script>var element = document.getElementById("moose-equation-348a3f02-4ef6-47c8-b7e7-a40622af7425");katex.render("yy", element, {displayMode:false,throwOnError:false});</script></span>, <span class="moose-katex-inline-equation" id="moose-equation-56d28777-e87d-4519-b9a7-92e5cf4cd362"><script>var element = document.getElementById("moose-equation-56d28777-e87d-4519-b9a7-92e5cf4cd362");katex.render("zz", element, {displayMode:false,throwOnError:false});</script></span>, <span class="moose-katex-inline-equation" id="moose-equation-1384721d-d9b4-42ad-8bc6-53589afd233f"><script>var element = document.getElementById("moose-equation-1384721d-d9b4-42ad-8bc6-53589afd233f");katex.render("yz", element, {displayMode:false,throwOnError:false});</script></span>, <span class="moose-katex-inline-equation" id="moose-equation-b251fd77-a974-47d2-9fef-96aad6dbfd81"><script>var element = document.getElementById("moose-equation-b251fd77-a974-47d2-9fef-96aad6dbfd81");katex.render("xz", element, {displayMode:false,throwOnError:false});</script></span> <span class="moose-katex-inline-equation" id="moose-equation-d3e807f8-c00f-4547-a813-27c6405d68a7"><script>var element = document.getElementById("moose-equation-d3e807f8-c00f-4547-a813-27c6405d68a7");katex.render("xy", element, {displayMode:false,throwOnError:false});</script></span></td><td style=";text-align:center">9: <span class="moose-katex-inline-equation" id="moose-equation-d8b249a6-d6a7-470c-af8b-8cfa69138fe1"><script>var element = document.getElementById("moose-equation-d8b249a6-d6a7-470c-af8b-8cfa69138fe1");katex.render("xx", element, {displayMode:false,throwOnError:false});</script></span>, <span class="moose-katex-inline-equation" id="moose-equation-83f229d4-65a6-4f21-964c-9e49d082c988"><script>var element = document.getElementById("moose-equation-83f229d4-65a6-4f21-964c-9e49d082c988");katex.render("xy", element, {displayMode:false,throwOnError:false});</script></span>, <span class="moose-katex-inline-equation" id="moose-equation-cbf0c58b-90c2-4d28-9e86-e231b031d3fe"><script>var element = document.getElementById("moose-equation-cbf0c58b-90c2-4d28-9e86-e231b031d3fe");katex.render("xz", element, {displayMode:false,throwOnError:false});</script></span>, <span class="moose-katex-inline-equation" id="moose-equation-5537b76b-8564-4b0e-a2f9-15532a07be20"><script>var element = document.getElementById("moose-equation-5537b76b-8564-4b0e-a2f9-15532a07be20");katex.render("yx", element, {displayMode:false,throwOnError:false});</script></span>, <span class="moose-katex-inline-equation" id="moose-equation-5a9fbb82-2754-467c-9a4f-e60c6b27dfdd"><script>var element = document.getElementById("moose-equation-5a9fbb82-2754-467c-9a4f-e60c6b27dfdd");katex.render("yy", element, {displayMode:false,throwOnError:false});</script></span>, <span class="moose-katex-inline-equation" id="moose-equation-51c836ce-5a91-47e7-a364-4db0fa9b5842"><script>var element = document.getElementById("moose-equation-51c836ce-5a91-47e7-a364-4db0fa9b5842");katex.render("yz", element, {displayMode:false,throwOnError:false});</script></span>, <span class="moose-katex-inline-equation" id="moose-equation-b6ab94da-2d48-4665-9c94-4c3ad1ec25f2"><script>var element = document.getElementById("moose-equation-b6ab94da-2d48-4665-9c94-4c3ad1ec25f2");katex.render("zx", element, {displayMode:false,throwOnError:false});</script></span>, <span class="moose-katex-inline-equation" id="moose-equation-f48500b6-aadd-4ccf-94ef-cb9c104eba31"><script>var element = document.getElementById("moose-equation-f48500b6-aadd-4ccf-94ef-cb9c104eba31");katex.render("zy", element, {displayMode:false,throwOnError:false});</script></span>, <span class="moose-katex-inline-equation" id="moose-equation-e57f7305-4d4a-4650-9c7a-d694a0dfa449"><script>var element = document.getElementById("moose-equation-e57f7305-4d4a-4650-9c7a-d694a0dfa449");katex.render("zz", element, {displayMode:false,throwOnError:false});</script></span></td></tr></tbody></table></div></div></div><p>To meet these cell average stress or strain components the system introduces an extra,  affine displacement field over the domain <span class="moose-katex-block-equation"><span class="moose-katex-equation table-cell" id="moose-equation-bd1531fa-3b0e-4513-ac86-31528d0b62b4"></span><script>var element = document.getElementById("moose-equation-bd1531fa-3b0e-4513-ac86-31528d0b62b4");katex.render("      u_{i}=u_{i}^{\\mu}+u_{i}^{M}", element, {displayMode:true,throwOnError:false});</script></span> where <span class="moose-katex-inline-equation" id="moose-equation-e751bed6-5357-4e41-a2ce-e5d42b5cf4dd"><script>var element = document.getElementById("moose-equation-e751bed6-5357-4e41-a2ce-e5d42b5cf4dd");katex.render("u_{i}^\\mu", element, {displayMode:false,throwOnError:false});</script></span> is the interpolated displacement field arising from the standard finite element problem and  <span class="moose-katex-block-equation"><span class="moose-katex-equation table-cell" id="moose-equation-3761c4d5-9c47-407f-af59-56c1cd8238f2"></span><script>var element = document.getElementById("moose-equation-3761c4d5-9c47-407f-af59-56c1cd8238f2");katex.render("      u_{i}^{M}=G_{iJ}X_{J}", element, {displayMode:true,throwOnError:false});</script></span> for some constant gradient tensor <span class="moose-katex-inline-equation" id="moose-equation-117dda5d-cb8d-410a-a8f8-1583c9ae7f06"><script>var element = document.getElementById("moose-equation-117dda5d-cb8d-410a-a8f8-1583c9ae7f06");katex.render("G_{iJ}", element, {displayMode:false,throwOnError:false});</script></span>. For small deformations the gradient tensor is symmetric, for large deformations it is not. In either case, the system adds this extra gradient to the deformation gradient calculated from the micro displacement field <span class="moose-katex-inline-equation" id="moose-equation-1525f10a-e951-4208-8016-4acb667c8f49"><script>var element = document.getElementById("moose-equation-1525f10a-e951-4208-8016-4acb667c8f49");katex.render("u_i^{\\mu}", element, {displayMode:false,throwOnError:false});</script></span> before forming the strain measures and calculating the resulting stress. <span class="moose-katex-block-equation"><span class="moose-katex-equation table-cell" id="moose-equation-b059058b-d51c-403d-85ca-af9d2c404d94"></span><script>var element = document.getElementById("moose-equation-b059058b-d51c-403d-85ca-af9d2c404d94");katex.render("      F_{iJ}=\\delta_{iJ}+u_{i,J}^{\\mu}+u_{i,J}^{M}=\\delta_{iJ}+u_{i,J}^{\\mu}+G_{iJ}.", element, {displayMode:true,throwOnError:false});</script></span> The framework represents the constant field <span class="moose-katex-inline-equation" id="moose-equation-e5a20c8a-e721-46bc-9cdc-ac5be362439c"><script>var element = document.getElementById("moose-equation-e5a20c8a-e721-46bc-9cdc-ac5be362439c");katex.render("G_{iJ}", element, {displayMode:false,throwOnError:false});</script></span> with a MOOSE <a href="../../source/postprocessors/ScalarVariable.html">scalar variable</a>.</p><p>The system implements the constrains by imposing a scalar residual equation for each specificed constraint: <span class="moose-katex-block-equation"><span class="moose-katex-equation table-cell" id="moose-equation-b4694ace-976a-4e3d-8b94-8ccf1810f2fa"></span><script>var element = document.getElementById("moose-equation-b4694ace-976a-4e3d-8b94-8ccf1810f2fa");katex.render("      R=\\int_{V}\\left(X-\\hat{X}\\right)dV=0", element, {displayMode:true,throwOnError:false});</script></span> where <span class="moose-katex-inline-equation" id="moose-equation-42be42c8-743a-4555-87ce-41b0a7619881"><script>var element = document.getElementById("moose-equation-42be42c8-743a-4555-87ce-41b0a7619881");katex.render("X", element, {displayMode:false,throwOnError:false});</script></span> represents a stress or deformation constrain, as appropriate. This constraint is implemented as a <code>ScalarKernel</code>.  using a <a href="../../source/userobjects/UserObject.html">UserObject</a> to visit each element and compute the volume integral.</p></section><section id="e1fc6383-5566-4df8-b243-18306276574c" data-section-level="2" data-section-text="Example Simulation"><h2 id="example-simulation">Example Simulation</h2><p><a href="#hsetup">Figure 1</a> shows a simple, but representative, sample simulation.  It consists of a square, 2D simulation cell subdivided into four subdomain.  The material model in each subdomain is a <a href="../../source/materials/lagrangian/ComputeStVenantKirchhoffStress.html">St. Venant-Kirchhoff</a> model, but the material properties in each subdomain are different as indicated on the figure. The problem imposes a combination of deformation gradient and 1st Piola Kirchhoff constraints on the simulation cell.</p><div class="card moose-float" style="width:50%;float:center;padding-top:1.5%;" id="hsetup"><div class="card-content"><picture class="materialboxed moose-image"><img src="../../large_media/tensor_mechanics/homogenization-setup.png"></img></picture><p class="moose-caption"><span class="moose-caption-heading">Figure 1: </span><span class="moose-caption-text" id="hsetup">Simple, 2D large deformation homogenization cell problem.</span></p></div></div><p><a href="#strain">Figure 2</a> and <a href="#stress">Figure 3</a> illustrate that the cell average stress and strain match the constraints for the controlled components of the 1st Piola-Kirchhoff and deformation gradient tensor.  The uncontrolled components can vary to maintain equilibrium in the body.  Because each subdomain has different material properties the microdisplacements are not homogeneous, producing an inhomogeneous stress state in the simulation cell.</p><div class="card moose-float" style="width:50%;float:center;padding-top:1.5%;" id="strain"><div class="card-content"><picture class="materialboxed moose-image"><img src="../../large_media/tensor_mechanics/homogenization-strain.png"></img></picture><p class="moose-caption"><span class="moose-caption-heading">Figure 2: </span><span class="moose-caption-text" id="strain">Results showing that the controlled deformation values match their targets.</span></p></div></div><div class="card moose-float" style="width:50%;float:center;padding-top:1.5%;" id="stress"><div class="card-content"><picture class="materialboxed moose-image"><img src="../../large_media/tensor_mechanics/homogenization-stress.png"></img></picture><p class="moose-caption"><span class="moose-caption-heading">Figure 3: </span><span class="moose-caption-text" id="stress">Results showing that the controlled stress values match their targets.</span></p></div></div><p>The homogenization system works for 1D, 2D, and 3D problems and for any material model.</p></section><section id="598eec11-9148-403b-9ad9-9b1b159a2bff" data-section-level="2" data-section-text="Implementation and Requirements"><h2 id="implementation-and-requirements">Implementation and Requirements</h2><p>The homogenization system relies on several different objects to impose the constraint residual, specify the constraints, and add the appropriate off-diagonal Jacobian terms. The easiest way to set up a homogenization problem is to use the <a href="../../syntax/Modules/TensorMechanics/Master/index.html">TensorMechanics/MasterAction</a> which automatically configures the correct MOOSE objects.</p><div class="card moose-alert moose-alert-warning"><div class="card-title moose-alert-title"><i class="material-icons moose-inline-icon">warning</i><span class="moose-alert-title-brand">warning</span></div><div class="card-content"><div class="moose-alert-content"><p>The homogenization constraint system only works with the <a href="../../source/kernels/lagrangian/TotalLagrangianStressDivergence.html">total Lagrangian</a>  implementation of the stress equilibrium kernel.  Specifically, you must use the <a href="../../source/kernels/lagrangian/HomogenizedTotalLagrangianStressDivergence.html"><code>HomogenizedTotalLagrangianStressDivergence</code></a> subclass as it implements the correct off-diagonal Jacobian entries.</p></div></div></div><p>The basic requirements the user must setup before imposing the homogenization constraints are:</p><ol class="browser-default" start="1"><li><p>Setup the unconstrained problem up to the specification of boundary conditions. </p></li><li><p>Impose periodic boundary conditions on the simulation domain in all directions, using the <a href="../../source/actions/AddPeriodicBCAction.html">AddPeriodicBCAction</a>. </p></li><li><p>Add Dirichlet boundary conditions to constrain the rigid body modes.  How to do this will be problem dependent, however a typical method is to constrain 1 (1D), 2 (2D) or 3 (3D) individual nodes with enough Dirichlet conditions to remove the rigid translation and rotation modes.</p></li></ol><p>These actions are <em>not</em> automatically taken care of by the action.  At this point the problem should run (i.e. be well-posed with sufficient constraint to solve the stress equilibrium equations) but produce zero deformation or loading.</p><p>The final step the user must take is to define their constraints using MOOSE <a href="../../syntax/Functions/index.html">Functions</a>.</p><div class="card moose-alert moose-alert-warning"><div class="card-title moose-alert-title"><i class="material-icons moose-inline-icon">warning</i><span class="moose-alert-title-brand">warning</span></div><div class="card-content"><div class="moose-alert-content"><p>For large deformation problems in 2D and 3D the user must specify at least 1 off-diagonal displacement constraint (2D) and at  least 3 off-diagonal displacement gradient constraints (3D).  That is, not all of the constraints can be stress constraints for large deformations.  An unconstrained displacement gradient admits free rigid body rotation and these modes must removed.</p></div></div></div><p>The following steps then provide the homogenization constraints.  These steps can be replaced by  the appropriate options in the <a href="../../syntax/Modules/TensorMechanics/Master/index.html">TensorMechanics/MasterAction</a>.</p><ol class="browser-default" start="1"><li><p>Add a <code>ScalarVariable</code> with the appropriate order for the problem being solved (see <a href="#sizes">Table 1</a>). </p></li><li><p>Add a <a href="../../source/userobjects/lagrangian/HomogenizationConstraint.html"><code>HomogenizationConstraint</code></a> <code>UserObject</code> to calculate the volume-averaged constraint value. </p></li><li><p>Add a <a href="../../source/scalarkernels/lagrangian/HomogenizationConstraintScalarKernel.html"><code>HomogenizationConstraintScalarKernel</code></a> to enforce the constraints. </p></li><li><p>Add a <a href="../../source/materials/lagrangian/ComputeHomogenizedLagrangianStrain.html"><code>ComputeHomogenizedLagrangianStrain</code></a> material object to convert the values of the scalar variable to  the homogenization strain or displacement gradient. </p></li><li><p>Inform the <a href="../../source/materials/lagrangian/ComputeLagrangianStrain.html"><code>ComputeLagrangianStrain</code></a> object of the name of the homogenization strain with the <code>homogenization_gradient_names</code> parameter. </p></li><li><p>Use <a href="../../source/kernels/lagrangian/HomogenizedTotalLagrangianStressDivergence.html"><code>HomogenizedTotalLagrangianStressDivergence</code></a> kernels and inform the kernels of the constraints so that they can  include the appropriate off-diagonal Jacobian entries with the <code>macro_gradient</code>, and <code>constraint_types</code> parameters.</p></li></ol></section><section id="f804b642-1a31-4893-8dde-fd552883f085" data-section-level="2" data-section-text="References"><h2 id="references">References</h2><div class="moose-bibliography"><ol><li id="danielsson2002three">M&nbsp;Danielsson, DM&nbsp;Parks, and MC&nbsp;Boyce.
Three-dimensional micromechanical modeling of voided polymeric materials.
<em>Journal of the Mechanics and Physics of Solids</em>, 50(2):351–379, 2002.<a href="#3d581a30-832a-474b-a12e-6988dedb555a" class="modal-trigger moose-bibtex-modal" style="padding-left:10px;">[BibTeX]</a><div class="modal" id="3d581a30-832a-474b-a12e-6988dedb555a"><div class="modal-content"><pre style="line-height:1.25;"><code class="language-latex">@article{danielsson2002three,
    author = "Danielsson, M and Parks, DM and Boyce, MC",
    title = "Three-dimensional micromechanical modeling of voided polymeric materials",
    journal = "Journal of the Mechanics and Physics of Solids",
    volume = "50",
    number = "2",
    pages = "351--379",
    year = "2002",
    publisher = "Elsevier"
}
</code></pre></div></div></li></ol></div></section></section></div></div></div></main></div></body><script type="text/javascript" src="../../contrib/materialize/materialize.min.js"></script><script type="text/javascript" src="../../contrib/clipboard/clipboard.min.js"></script><script type="text/javascript" src="../../contrib/prism/prism.min.js"></script><script type="text/javascript" src="../../js/init.js"></script><script type="text/javascript" src="../../js/navigation.js"></script><script type="text/javascript" src="../../contrib/fuse/fuse.min.js"></script><script type="text/javascript" src="../../js/search_index.js"></script><script type="text/javascript" src="../../js/sqa_moose.js"></script>