<!DOCTYPE html><head><meta charset="UTF-8"><title>Radial Return Stress Update with automatic differentaiation | Chamois</title><link rel="icon" type="image/x-icon" href="../../media/chamois_logo.png" sizes="16x16 32x32 64x64 128x128"></link><link href="../../contrib/materialize/materialize.min.css" type="text/css" rel="stylesheet" media="screen,projection"></link><link href="../../contrib/prism/prism.min.css" type="text/css" rel="stylesheet"></link><link href="../../css/moose.css" type="text/css" rel="stylesheet"></link><link href="../../css/devel_moose.css" type="text/css" rel="stylesheet"></link><link href="../../css/alert_moose.css" type="text/css" rel="stylesheet"></link><link href="../../css/content_moose.css" type="text/css" rel="stylesheet"></link><link href="../../css/sqa_moose.css" type="text/css" rel="stylesheet"></link><link href="../../css/civet_moose.css" type="text/css" rel="stylesheet"></link><link href="../../contrib/katex/katex.min.css" type="text/css" rel="stylesheet"></link><link href="../../css/katex_moose.css" type="text/css" rel="stylesheet"></link><script type="text/javascript" src="../../contrib/jquery/jquery.min.js"></script><script type="text/javascript" src="../../contrib/katex/katex.min.js"></script></head><body><div class="page-wrap"><header><nav><div class="nav-wrapper container"><a href="../../index.html" class="left moose-logo hide-on-med-and-down" id="home-button">Chamois</a><a href="https://github.com/matthiasneuner/chamois" class="right"><img src="../../media/framework/github-logo.png" class="github-mark"></img><img src="../../media/framework/github-mark.png" class="github-logo"></img></a><ul class="right hide-on-med-and-down"><li><a href="../../getting_started.html">Getting Started</a></li><li><a href="../../singularity.html">Singularity container</a></li><li><a href="../../publications.html">Publications</a></li><li><a href="../../contributors.html">Contributors</a></li><li><a href="#!" class="dropdown-trigger" data-target="4d8248d1-6843-41b2-9450-229ab7570283" data-constrainWidth="false">Documentation<i class="material-icons right">arrow_drop_down</i></a></li></ul><a href="#" class="sidenav-trigger" data-target="b7737fdc-7d99-40cc-bf1e-2d6f8b02918a"><i class="material-icons">menu</i></a><ul class="sidenav" id="b7737fdc-7d99-40cc-bf1e-2d6f8b02918a"><li><a href="../../getting_started.html">Getting Started</a></li><li><a href="../../singularity.html">Singularity container</a></li><li><a href="../../publications.html">Publications</a></li><li><a href="../../contributors.html">Contributors</a></li><li><a href="#!" class="dropdown-trigger" data-target="35a20227-67ae-4e94-8673-b390e6527744" data-constrainWidth="false">Documentation<i class="material-icons right">arrow_drop_down</i></a></li></ul><a href="#moose-search" class="modal-trigger"><i class="material-icons">search</i></a></div><ul class="dropdown-content" id="4d8248d1-6843-41b2-9450-229ab7570283"><li><a href="../../syntax/chamois.html">Chamois syntax</a></li></ul><ul class="dropdown-content" id="35a20227-67ae-4e94-8673-b390e6527744"><li><a href="../../syntax/chamois.html">Chamois syntax</a></li></ul></nav><div class="modal modal-fixed-footer moose-search-modal" id="moose-search"><div class="modal-content container moose-search-modal-content"><div class="row"><div class="col l12"><div class="input-field"><input type_="text" onkeyup="mooseSearch()" placeholder="/index.md" id="moose-search-box"></input></div></div><div><div class="col s12" id="moose-search-results"></div></div></div></div><div class="modal-footer"><a href="#!" class="modal-close btn-flat">Close</a></div></div></header><main class="main"><div class="container"><div class="row"><div class="moose-content col s12 m12 l12"><section id="79fb7abd-86bb-4a6c-a8aa-b002c6c49bf8" data-section-level="1" data-section-text="Radial Return Stress Update with automatic differentaiation"><h1 id="radial-return-stress-update-with-automatic-differentaiation">Radial Return Stress Update with automatic differentaiation</h1><p>Base class which calculates the effective inelastic strain increment required to return the isotropic stress state to a J2 yield surface.  This class is intended to be a parent class for classes with specific constitutive models.</p><section id="d0456ccb-fbf2-44c2-bebc-ebc8f3c26a90" data-section-level="3" data-section-text="Algorithm References"><h3 id="algorithm-references">Algorithm References</h3><p>The radial return mapping method, introduced by Simo and Taylor (1985), uses a von Mises yield surface to determine the increment of plastic strain necessary to return the stress state to the yield surface after a trial stress increment takes the computed stress state across the yield surface.  Because the von Mises yield surface in the deviatoric stress space has the shape of a circle, the _plastic correction stress_ is always directed towards the center of the yield surface circle.</p><p>In addition to the <a href="#simo2006computational">Simo and Hughes (2006)</a> textbook, <a href="#dunne2005introduction">Dunne and Petrinic (2005)</a> is an excellent reference for users working with the <code>RadialReturnStressUpdate</code> materials; several of the isotropic plasticity and creep effective plastic strain increment algorithms are taken from <a href="#dunne2005introduction">Dunne and Petrinic (2005)</a>.</p></section><section id="4376b0fa-1877-4c0f-8117-fbc794cf531a" data-section-level="3" data-section-text="The Radial Return Stress Update Description"><h3 id="the-radial-return-stress-update-description">The Radial Return Stress Update Description</h3><p>The stress update materials are not called by MOOSE directly but instead only by other materials using the <code>computeProperties</code> method.  For the <code>ADRadialReturnStressUpdate</code> materials, this calling material is <a href="ADComputeMultipleInelasticStress.html">ADComputeMultipleInelasticStress</a>. Separating the call to the stress update materials from MOOSE allows us to iteratively call the stress update materials as is required to achieve convergence.</p></section></section><section id="d0ad3d47-fcf6-4b53-b438-ba512ed386cf" data-section-level="2" data-section-text="Radial Return Algorithm Overview"><h2 id="radial-return-algorithm-overview">Radial Return Algorithm Overview</h2><div class="card moose-float" style="width:30%;margin-left:2%;float:right"><div class="card-content"><picture class="materialboxed moose-image"><img src="../../media/tensor_mechanics/RadialReturnStressSpace.png"></img></picture><p class="moose-caption"><span class="moose-caption-text">A trial stress is shown outside of the deviatoric yield surface and the radial return                  stress which is normal to the yield surface.</span></p></div></div><p>In this numerical approach, a trial stress is calculated at the start of each simulation time increment; the trial stress calculation assumed all of the new strain increment is elastic strain:</p><p><span class="moose-katex-block-equation"><span class="moose-katex-equation table-cell" id="moose-equation-cee9d08e-1aa1-47bc-9217-2d6cdc9283ed"></span><script>var element = document.getElementById("moose-equation-cee9d08e-1aa1-47bc-9217-2d6cdc9283ed");katex.render("\\sigma_{trial} = C_{ijkl} \\left( \\Delta \\epsilon_{assumed-elastic} + \\epsilon_{elastic}^{old} \\right)", element, {displayMode:true,throwOnError:false});</script></span></p><p>The algorithms checks to see if the trial stress state is outside of the yield surface, as shown in the figure to the right. If the stress state is outside of the yield surface, the algorithm recomputes the scalar effective inelastic strain required to return the stress state to the yield surface. This approach is given the name Radial Return because the yield surface used is the <a href="https://en.wikipedia.org/wiki/Von_Mises_yield_criterion">von Mises yield surface</a>: in the <a href="https://en.wikipedia.org/wiki/Cauchy_stress_tensor#Stress_deviator_tensor">devitoric stress space</a>, this yield surface has the shape of a circle, and the scalar inelastic strain is assumed to always be directed at the circle center.</p><section id="4b42d8dc-6777-4520-b3ba-5bf8e10642ad" data-section-level="3" data-section-text="Recompute Iterations on the Effective Plastic Strain Increment"><h3 id="recompute-iterations-on-the-effective-plastic-strain-increment">Recompute Iterations on the Effective Plastic Strain Increment</h3><p>The recompute radial return materials each individually calculate, using the <a href="http://mathworld.wolfram.com/NewtonsMethod.html">Newton Method</a>, the amount of effective inelastic strain required to return the stress state to the yield surface.</p><p><span class="moose-katex-block-equation"><span class="moose-katex-equation table-cell" id="moose-equation-e9915fd6-db89-4f77-9227-bc21e072d007"></span><script>var element = document.getElementById("moose-equation-e9915fd6-db89-4f77-9227-bc21e072d007");katex.render("\\Delta p^{(t+1)} = \\Delta p^t + d \\Delta p", element, {displayMode:true,throwOnError:false});</script></span></p><p>where the change in the iterative effective inelastic strain is defined as the yield surface over the derivative of the yield surface with respect to the inelastic strain increment. </p><p>In the case of isotropic linear hardening plasticity, with the hardening function <span class="moose-katex-inline-equation" id="moose-equation-6f34b674-c34b-4efe-be80-cb9b4a46e592"><script>var element = document.getElementById("moose-equation-6f34b674-c34b-4efe-be80-cb9b4a46e592");katex.render("r = hp", element, {displayMode:false,throwOnError:false});</script></span>, the effective plastic strain increment has the form: <span class="moose-katex-block-equation"><span class="moose-katex-equation table-cell" id="moose-equation-a044b1ab-9005-4ce0-b7f9-c2db96c42ee8"></span><script>var element = document.getElementById("moose-equation-a044b1ab-9005-4ce0-b7f9-c2db96c42ee8");katex.render(" d \\Delta p = \\frac{\\sigma^{trial}_{effective} - 3 G \\Delta p - r - \\sigma_{yield}}{3G + h}", element, {displayMode:true,throwOnError:false});</script></span> where G is the isotropic shear modulus, and <span class="moose-katex-inline-equation" id="moose-equation-40e3c17a-8c8b-4d46-918d-e02cac375b82"><script>var element = document.getElementById("moose-equation-40e3c17a-8c8b-4d46-918d-e02cac375b82");katex.render("\\sigma^{trial}_{effective}", element, {displayMode:false,throwOnError:false});</script></span> is the scalar von Mises trial stress.</p><p>Once convergence has been reached on the scalar inelastic strain increment, the full inelastic strain tensor is calculated. <span class="moose-katex-block-equation"><span class="moose-katex-equation table-cell" id="moose-equation-7f143a35-c1b7-460a-98ba-3ae437960df3"></span><script>var element = document.getElementById("moose-equation-7f143a35-c1b7-460a-98ba-3ae437960df3");katex.render("\\Delta \\epsilon^{inelastic}_{ij} = \\frac{3}{2} \\Delta p^{(t+1)} \\frac{dev(\\sigma^{trial}_{ij})}{\\sigma^{trial}_{effective}}", element, {displayMode:true,throwOnError:false});</script></span></p><p>The elastic strain is calculated by subtracting the return mapping inelastic strain increment tensor from the mechanical strain tensor.  Mechanical strain is considered as the sum of the elastic and inelastic (plastic, creep, ect) strains. <span class="moose-katex-block-equation"><span class="moose-katex-equation table-cell" id="moose-equation-0a76ec99-2f91-4357-9433-dd37abfa0a43"></span><script>var element = document.getElementById("moose-equation-0a76ec99-2f91-4357-9433-dd37abfa0a43");katex.render("\\epsilon_{total} = \\epsilon_{mechanical} + \\epsilon_{eigenstrain} = \\left( \\epsilon_{elastic} + \\epsilon_{inelastic} \\right) + \\epsilon_{eigenstrain} = \\epsilon_{elastic} + \\left( \\epsilon_{plastic} + \\epsilon_{creep} + \\epsilon_{damage}  \\right) + \\epsilon_{eigenstrain}", element, {displayMode:true,throwOnError:false});</script></span></p><p>The final inelastic strain is returned from the radial return stress update material, and <code>ComputeMultipleInelasticStress</code> computes the stress, with a return mapping stress increment following elasticity theory for finite strains. The final stress is calculated from the elastic strain increment. <span class="moose-katex-block-equation"><span class="moose-katex-equation table-cell" id="moose-equation-808ffa65-e476-4133-ba8b-76b4b2cd7de5"></span><script>var element = document.getElementById("moose-equation-808ffa65-e476-4133-ba8b-76b4b2cd7de5");katex.render("\\sigma^{new}_{ij} = C_{ijkl} \\left( \\Delta \\epsilon^{elastic}_{kl} + \\epsilon^{old-elastic}_{kl} \\right)", element, {displayMode:true,throwOnError:false});</script></span></p><p>When more than one radial recompute material is included in the simulation, as in Combined Power Law Creep and Linear Strain Hardening, <code>ComputeMultipleInelasticStress</code> will iterate over the change in the calculated stress until the return stress has reached a stable value.</p><p>Users can print out any of these strains and stresses using the <code>RankTwoAux</code> as described on the <a href="../../modules/tensor_mechanics/VisualizingTensors.html">Visualizing Tensors</a> page.</p></section></section><section id="73d256ea-d2b1-499e-a7ee-c6ea837ad4ed" data-section-level="2" data-section-text="Writing a New Stress Update Material New radial return models must inherit from and must overwrite the six virtual methods . RadialReturnStressUpdate"><h2 id="writing-a-new-stress-update-material-new-radial-return-models-must-inherit-from-and-must-overwrite-the-six-virtual-methods">Writing a New Stress Update Material New radial return models must inherit from <code>RadialReturnStressUpdate</code> and must overwrite the six virtual methods.</h2><ul class="browser-default"><li><p><strong>initQpStatefulProperties</strong>: Set the initial values for all new material properties that are not initialized by an input parameter; generally the material properties initialized in this method are all set to zero. </p></li><li><p><strong>computeStressInitialize</strong>: Calculate the initial trial stress state, the yield surface value, and any hardening or softening parameters at the start of the simulation time increment. </p></li><li><p><strong>computeResidual</strong>: In each iteration over the inelastic strain increment, calculate the value of the effective scalar trial stress subtracted by the yield surface function. </p></li><li><p><strong>computeDerivative</strong>: In each iteration over the inelastic strain increment, calculate the derivative of the yield surface function with respect to the inelastic strain increment. </p></li><li><p><strong>iterationFinalize</strong>: Store the value of the inelastic strain increment at the end of each iteration. </p></li><li><p><strong>computeStressFinalize</strong>: Update the stress after convergence on the inelastic strain increment has been reached.</p></li></ul><p>Additionally, new radial return methods must also overwrite a single method from the MOOSE <code>Material</code> class.</p><ul class="browser-default"><li><p><strong>resetQpProperties</strong>: Set the material property used in the iteration, usually <span class="moose-katex-inline-equation" id="moose-equation-881288a2-4c02-4737-ac2e-1877f68f3932"><script>var element = document.getElementById("moose-equation-881288a2-4c02-4737-ac2e-1877f68f3932");katex.render("\\Delta p", element, {displayMode:false,throwOnError:false});</script></span>, to zero at the start the iteration.  This method is necessary to avoid incorrect material property values.</p></li></ul><p>More details on how to write the equivalent yield surface equation for a creep model are given in Dunne and Petrinic.</p></section><section id="a9258fdc-82f9-472f-ad40-ec360d482bc0" data-section-level="2" data-section-text="Substepping"><h2 id="substepping">Substepping</h2><p>We provide the substepping capability in <code>ADRadialReturnStressUpdate</code> for nonlinear material models in order to improve the convergence. The idea is that when material is undergoing large deformation and the return mapping algorithm struggles to converge, we would divide the original strain into smaller strain increments and take several substeps where incremental strain is applied at each substep.  The following shows an example of the syntax for using substepping.</p><pre class="moose-pre" style="max-height:350px;"><code class="language-text">[power_law_creep]
  type = PowerLawCreepStressUpdate
  coefficient = 1.0e-15
  n_exponent = 4
  activation_energy = 0.0
  temperature = temp
  # options for using substepping
  substep_strain_tolerance = 0.1
  max_inelastic_increment = 0.01
[]
</code></pre><a class="moose-source-filename tooltipped modal-trigger" href="#9cf7473c-d236-4ea4-81e8-d23bb18b2456">(moose/modules/tensor_mechanics/test/tests/substepping/power_law_creep.i)</a><p></p></section><section id="d4fa86fd-21c4-465d-a8f6-ac8b296ebe24" data-section-level="2" data-section-text="References"><h2 id="references">References</h2><div class="moose-bibliography"><ol><li id="dunne2005introduction">Fionn Dunne and Nik Petrinic.
<em>Introduction to Computational Plasticity</em>.
Oxford University Press on Demand, 2005.<a href="#aeadbcc9-e325-4be6-ab9e-cbaac4187018" class="modal-trigger moose-bibtex-modal" style="padding-left:10px;">[BibTeX]</a><div class="modal" id="aeadbcc9-e325-4be6-ab9e-cbaac4187018"><div class="modal-content"><pre style="line-height:1.25;"><code class="language-latex">@book{dunne2005introduction,
    author = "Dunne, Fionn and Petrinic, Nik",
    title = "Introduction to Computational Plasticity",
    year = "2005",
    publisher = "Oxford University Press on Demand"
}
</code></pre></div></div></li><li id="simo2006computational">Juan&nbsp;C Simo and Thomas&nbsp;JR Hughes.
<em>Computational inelasticity</em>.
Volume&nbsp;7.
Springer Science &amp; Business Media, 2006.<a href="#854cdffc-440e-424f-bde3-f04bb0c9602b" class="modal-trigger moose-bibtex-modal" style="padding-left:10px;">[BibTeX]</a><div class="modal" id="854cdffc-440e-424f-bde3-f04bb0c9602b"><div class="modal-content"><pre style="line-height:1.25;"><code class="language-latex">@book{simo2006computational,
    author = "Simo, Juan C and Hughes, Thomas JR",
    title = "Computational inelasticity",
    volume = "7",
    year = "2006",
    publisher = "Springer Science \\& Business Media"
}
</code></pre></div></div></li></ol></div></section><div class="moose-modal modal" id="9cf7473c-d236-4ea4-81e8-d23bb18b2456"><div class="modal-content"><h4>(moose/modules/tensor_mechanics/test/tests/substepping/power_law_creep.i)</h4><pre class="moose-pre"><code class="language-text">[GlobalParams]
  displacements = &#x27;disp_x disp_y disp_z&#x27;
[]

[Mesh]
  [gen]
    type = GeneratedMeshGenerator
    dim = 3
    nx = 2
    ny = 2
    nz = 2
  []
[]

[AuxVariables]
  [temp]
    initial_condition = 1000.0
  []
[]

[Modules/TensorMechanics/Master]
  [all]
    strain = FINITE
    add_variables = true
    generate_output = &#x27;stress_zz elastic_strain_zz creep_strain_zz&#x27;
    use_automatic_differentiation = false
  []
[]

[Functions]
  [front_pull]
    type = PiecewiseLinear
    x = &#x27;0 1&#x27;
    y = &#x27;0 1&#x27;
    scale_factor = 0.5
  []
[]

[BCs]
  [u_front_pull]
    type = ADFunctionDirichletBC
    variable = disp_z
    boundary = front
    function = front_pull
  []
  [uz_back_fix]
    type = ADDirichletBC
    variable = disp_z
    boundary = back
    value = 0.0
  []
  [u_yz_fix]
    type = ADDirichletBC
    variable = disp_x
    boundary = left
    value = 0.0
  []
  [u_xz_fix]
    type = ADDirichletBC
    variable = disp_y
    boundary = bottom
    value = 0.0
  []
[]

[Materials]
  [elasticity_tensor]
    type = ComputeIsotropicElasticityTensor
    youngs_modulus = 2e11
    poissons_ratio = 0.3
  []
  [radial_return_stress]
    type = ComputeMultipleInelasticStress
    inelastic_models = &#x27;power_law_creep&#x27;
  []
  [power_law_creep]
    type = PowerLawCreepStressUpdate
    coefficient = 1.0e-15
    n_exponent = 4
    activation_energy = 0.0
    temperature = temp
    # options for using substepping
    substep_strain_tolerance = 0.1
    max_inelastic_increment = 0.01
  []
[]

[Executioner]
  type = Transient

  solve_type = &#x27;NEWTON&#x27;

  petsc_options_iname = &#x27;-pc_type &#x27;
  petsc_options_value = &#x27;lu     &#x27;

  line_search = &#x27;none&#x27;

  nl_max_its = 10
  nl_rel_tol = 1e-6
  nl_abs_tol = 1e-10

  end_time = 0.1
  dt = 0.1
[]

[Outputs]
  exodus = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div></div></div></div></main></div></body><script type="text/javascript" src="../../contrib/materialize/materialize.min.js"></script><script type="text/javascript" src="../../contrib/clipboard/clipboard.min.js"></script><script type="text/javascript" src="../../contrib/prism/prism.min.js"></script><script type="text/javascript" src="../../js/init.js"></script><script type="text/javascript" src="../../js/navigation.js"></script><script type="text/javascript" src="../../contrib/fuse/fuse.min.js"></script><script type="text/javascript" src="../../js/search_index.js"></script><script type="text/javascript" src="../../js/sqa_moose.js"></script>