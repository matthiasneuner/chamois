<!DOCTYPE html><head><meta charset="UTF-8"><title>Theory for the New Lagrangian Kernels | Chamois</title><link rel="icon" type="image/x-icon" href="../../media/chamois_logo.png" sizes="16x16 32x32 64x64 128x128"></link><link href="../../contrib/materialize/materialize.min.css" type="text/css" rel="stylesheet" media="screen,projection"></link><link href="../../contrib/prism/prism.min.css" type="text/css" rel="stylesheet"></link><link href="../../css/moose.css" type="text/css" rel="stylesheet"></link><link href="../../css/devel_moose.css" type="text/css" rel="stylesheet"></link><link href="../../css/alert_moose.css" type="text/css" rel="stylesheet"></link><link href="../../css/content_moose.css" type="text/css" rel="stylesheet"></link><link href="../../css/sqa_moose.css" type="text/css" rel="stylesheet"></link><link href="../../css/civet_moose.css" type="text/css" rel="stylesheet"></link><link href="../../contrib/katex/katex.min.css" type="text/css" rel="stylesheet"></link><link href="../../css/katex_moose.css" type="text/css" rel="stylesheet"></link><script type="text/javascript" src="../../contrib/jquery/jquery.min.js"></script><script type="text/javascript" src="../../contrib/katex/katex.min.js"></script></head><body><div class="page-wrap"><header><nav><div class="nav-wrapper container"><a href="../../index.html" class="left moose-logo hide-on-med-and-down" id="home-button">Chamois</a><a href="https://github.com/matthiasneuner/chamois" class="right"><img src="../../media/framework/github-logo.png" class="github-mark"></img><img src="../../media/framework/github-mark.png" class="github-logo"></img></a><ul class="right hide-on-med-and-down"><li><a href="../../getting_started.html">Getting Started</a></li><li><a href="../../singularity.html">Singularity container</a></li><li><a href="../../publications.html">Publications</a></li><li><a href="../../contributors.html">Contributors</a></li><li><a href="#!" class="dropdown-trigger" data-target="2c12ebee-a357-4018-9227-3dccf0a0ffc7" data-constrainWidth="false">Documentation<i class="material-icons right">arrow_drop_down</i></a></li></ul><a href="#" class="sidenav-trigger" data-target="257b1f53-4a90-4080-92bb-c1693b23cfcb"><i class="material-icons">menu</i></a><ul class="sidenav" id="257b1f53-4a90-4080-92bb-c1693b23cfcb"><li><a href="../../getting_started.html">Getting Started</a></li><li><a href="../../singularity.html">Singularity container</a></li><li><a href="../../publications.html">Publications</a></li><li><a href="../../contributors.html">Contributors</a></li><li><a href="#!" class="dropdown-trigger" data-target="1001cf4a-0445-4882-9211-3b882b859c56" data-constrainWidth="false">Documentation<i class="material-icons right">arrow_drop_down</i></a></li></ul><a href="#moose-search" class="modal-trigger"><i class="material-icons">search</i></a></div><ul class="dropdown-content" id="2c12ebee-a357-4018-9227-3dccf0a0ffc7"><li><a href="../../syntax/chamois.html">Chamois syntax</a></li></ul><ul class="dropdown-content" id="1001cf4a-0445-4882-9211-3b882b859c56"><li><a href="../../syntax/chamois.html">Chamois syntax</a></li></ul></nav><div class="modal modal-fixed-footer moose-search-modal" id="moose-search"><div class="modal-content container moose-search-modal-content"><div class="row"><div class="col l12"><div class="input-field"><input type_="text" onkeyup="mooseSearch()" placeholder="/index.md" id="moose-search-box"></input></div></div><div><div class="col s12" id="moose-search-results"></div></div></div></div><div class="modal-footer"><a href="#!" class="modal-close btn-flat">Close</a></div></div></header><main class="main"><div class="container"><div class="row"><div class="moose-content col s12 m12 l12"><section id="08c31464-0a2d-49de-b5c4-f011f20c9752" data-section-level="1" data-section-text="Theory for the New Lagrangian Kernels"><h1 id="theory-for-the-new-lagrangian-kernels">Theory for the New Lagrangian Kernels</h1><section id="86ce07ba-c5ff-4726-9a06-f686a45ceb52" data-section-level="2" data-section-text="Introduction"><h2 id="introduction">Introduction</h2><p>The new kernel system provides two options for enforcing stress equilibrium over a domain described by a map between the reference configuration of the body, defined as <span class="moose-katex-inline-equation" id="moose-equation-346ba1cb-3840-4ec5-a134-63fd1d55f64d"><script>var element = document.getElementById("moose-equation-346ba1cb-3840-4ec5-a134-63fd1d55f64d");katex.render("\\Omega_0", element, {displayMode:false,throwOnError:false});</script></span> with coordinates <span class="moose-katex-inline-equation" id="moose-equation-66bfd7a1-4b22-4746-9529-0f004f596393"><script>var element = document.getElementById("moose-equation-66bfd7a1-4b22-4746-9529-0f004f596393");katex.render("\\boldsymbol{X}", element, {displayMode:false,throwOnError:false});</script></span>, and the current configuration of the body defined as <span class="moose-katex-inline-equation" id="moose-equation-77712984-f7de-4987-9a8c-b12e6e1155a3"><script>var element = document.getElementById("moose-equation-77712984-f7de-4987-9a8c-b12e6e1155a3");katex.render("\\Omega", element, {displayMode:false,throwOnError:false});</script></span> with coordinates <span class="moose-katex-inline-equation" id="moose-equation-46df9195-5f9b-4184-bd23-3cf086a32d4f"><script>var element = document.getElementById("moose-equation-46df9195-5f9b-4184-bd23-3cf086a32d4f");katex.render("\\boldsymbol{x}", element, {displayMode:false,throwOnError:false});</script></span>. The mathematics here uses upper case letters to define quantities related to the reference configuration and lower case letters to define quantities related to the current configuration.  Specifically, <span class="moose-katex-block-equation"><span class="moose-katex-equation table-cell" id="moose-equation-21cd1ecd-3977-431b-a88d-c158827bbb32"></span><script>var element = document.getElementById("moose-equation-21cd1ecd-3977-431b-a88d-c158827bbb32");katex.render("      f_{i,j}=\\frac{\\partial f_{i}}{\\partial x_{j}}", element, {displayMode:true,throwOnError:false});</script></span> denotes a spatial gradient with respect to the current coordinates while <span class="moose-katex-block-equation"><span class="moose-katex-equation table-cell" id="moose-equation-a81d446a-0d1f-469b-81c9-930f82af6612"></span><script>var element = document.getElementById("moose-equation-a81d446a-0d1f-469b-81c9-930f82af6612");katex.render("      f_{i,J}=\\frac{\\partial f_{i}}{\\partial X_{j}}", element, {displayMode:true,throwOnError:false});</script></span> denotes a gradient with respect to the reference coordinates.  <a href="#potatoes">Figure 1</a> describes these two frames of reference. The new kernel system current supports three coordinate systems: <a href="../../source/interfaces/GradientOperator.html#3D_cartesian">3D Cartesian coordinates</a>, <a href="../../source/interfaces/GradientOperator.html#2D_axisymmetric_cylindrical">2D axisymmetric cylindrical coordinates</a>, and <a href="../../source/interfaces/GradientOperator.html#1D_centrosymmetric_spherical">1D centrosymmetric spherical coordinates</a>.</p><div class="card moose-float" style="width:30%;float:center;padding-top:1.5%;" id="potatoes"><div class="card-content"><picture class="materialboxed moose-image"><img src="../../large_media/tensor_mechanics/mechanics_potatoes.png"></img></picture><p class="moose-caption"><span class="moose-caption-heading">Figure 1: </span><span class="moose-caption-text" id="potatoes">Summary of the reference and current configurations with key quantities.</span></p></div></div><p>The <a href="../../source/kernels/lagrangian/TotalLagrangianStressDivergence.html">total Lagrangian</a> theory enforces the equilibrium condition mapped back to the reference configuration, weakly solving the differential equation: <span class="moose-katex-block-equation"><span class="moose-katex-equation table-cell" id="moose-equation-f3d2ad6d-790a-42f7-979e-659399ecc694"></span><script>var element = document.getElementById("moose-equation-f3d2ad6d-790a-42f7-979e-659399ecc694");katex.render("      \\begin{align*}       P_{iJ,J}+b_{i} & = & 0 & \\, \\mathrm{{on}\\, \\Omega_{0}}\\\\       P_{iJ}N_{j} & = & \\hat{t}_{i} & \\, \\mathrm{on}\\, \\partial\\Omega_{0,n}\\\\       u_{i} & = & \\hat{u}_{i} & \\, \\mathrm{on}\\, \\partial\\Omega_{0,e}       \\end{align*}", element, {displayMode:true,throwOnError:false});</script></span> where <span class="moose-katex-inline-equation" id="moose-equation-5858e5af-f296-4366-be5c-b20531b52589"><script>var element = document.getElementById("moose-equation-5858e5af-f296-4366-be5c-b20531b52589");katex.render("P_{iJ}", element, {displayMode:false,throwOnError:false});</script></span> is the 1st Piola-Kirchhoff stress, <span class="moose-katex-inline-equation" id="moose-equation-f086e89f-6dd7-4313-83bb-3a6a1a3ec5fc"><script>var element = document.getElementById("moose-equation-f086e89f-6dd7-4313-83bb-3a6a1a3ec5fc");katex.render("b_i", element, {displayMode:false,throwOnError:false});</script></span> are the body forces in the updated configuration, <span class="moose-katex-inline-equation" id="moose-equation-25cacb29-0253-439a-8a7a-ec206f0b98a4"><script>var element = document.getElementById("moose-equation-25cacb29-0253-439a-8a7a-ec206f0b98a4");katex.render("N_{j}", element, {displayMode:false,throwOnError:false});</script></span> are the boundary normals in the reference configuration, <span class="moose-katex-inline-equation" id="moose-equation-da4654d4-5dbd-494e-9516-b1c0dd92a0eb"><script>var element = document.getElementById("moose-equation-da4654d4-5dbd-494e-9516-b1c0dd92a0eb");katex.render("\\hat{t}_{i}", element, {displayMode:false,throwOnError:false});</script></span> are the tractions in the updated configuration, <span class="moose-katex-inline-equation" id="moose-equation-bf36226b-219d-4483-8404-ac7987b0ff1f"><script>var element = document.getElementById("moose-equation-bf36226b-219d-4483-8404-ac7987b0ff1f");katex.render("u_i", element, {displayMode:false,throwOnError:false});</script></span> is the displacement field, and <span class="moose-katex-inline-equation" id="moose-equation-bd9545e4-bc88-4f61-901b-44917ebbe1f2"><script>var element = document.getElementById("moose-equation-bd9545e4-bc88-4f61-901b-44917ebbe1f2");katex.render("\\hat{u}_{i}", element, {displayMode:false,throwOnError:false});</script></span> are imposed displacement boundary conditions.</p><p>The <a href="../../source/kernels/lagrangian/UpdatedLagrangianStressDivergence.html">updated Lagrangian</a> theory enforces the equilibrium condition on the current configuration: <span class="moose-katex-block-equation"><span class="moose-katex-equation table-cell" id="moose-equation-c151dc1f-1d2e-418a-8ddd-27106a022782"></span><script>var element = document.getElementById("moose-equation-c151dc1f-1d2e-418a-8ddd-27106a022782");katex.render("      \\begin{align*}       \\sigma_{ij,j}+b_{i} & = & 0 & \\, \\mathrm{{on}\\, \\Omega}\\\\       \\sigma_{ij}n_{j} & = & \\, \\hat{t}_{i} & \\mathrm{on}\\, \\partial\\Omega_{n}\\\\       u_{i} & = & \\hat{u}_{i} & \\, \\mathrm{on}\\, \\partial\\Omega_{e}       \\end{align*}", element, {displayMode:true,throwOnError:false});</script></span> where <span class="moose-katex-inline-equation" id="moose-equation-ecfb6090-b1c0-4e4e-b4c4-11125bde95c8"><script>var element = document.getElementById("moose-equation-ecfb6090-b1c0-4e4e-b4c4-11125bde95c8");katex.render("\\sigma_{ij}", element, {displayMode:false,throwOnError:false});</script></span> is the Cauchy stress.</p><p>It is more natural and common to define the constitutive response for the total Lagrangian formulation as the 1st Piola Kirchhoff stress as a function of the deformation gradient, <span class="moose-katex-inline-equation" id="moose-equation-f794095f-aabd-4c7f-b2fa-01f1c815cc96"><script>var element = document.getElementById("moose-equation-f794095f-aabd-4c7f-b2fa-01f1c815cc96");katex.render("P_{iJ}\\left(F_{kL}\\right)", element, {displayMode:false,throwOnError:false});</script></span> updated Lagrangian formulation as the Cauchy stress as a function of the deformation gradient, <span class="moose-katex-inline-equation" id="moose-equation-86d969ae-353d-44be-82a7-c51684132acf"><script>var element = document.getElementById("moose-equation-86d969ae-353d-44be-82a7-c51684132acf");katex.render("\\sigma_{ij}\\left(F_{kL}\\right)", element, {displayMode:false,throwOnError:false});</script></span>, with the deformation gradient defined as <span class="moose-katex-block-equation"><span class="moose-katex-equation table-cell" id="moose-equation-e95f5ffa-7ded-4f1c-943a-74cb86c9547f"></span><script>var element = document.getElementById("moose-equation-e95f5ffa-7ded-4f1c-943a-74cb86c9547f");katex.render("      F_{iJ} = \\delta_{i,J} + u_{i,J}", element, {displayMode:true,throwOnError:false});</script></span> with <span class="moose-katex-inline-equation" id="moose-equation-8395dc0b-dce6-4c68-bf41-32d98340f607"><script>var element = document.getElementById("moose-equation-8395dc0b-dce6-4c68-bf41-32d98340f607");katex.render("\\delta", element, {displayMode:false,throwOnError:false});</script></span> the Kronecker Delta. However, the Cauchy stress and the 1st Piola Kirchhoff stress are related <span class="moose-katex-block-equation"><span class="moose-katex-equation table-cell" id="moose-equation-9c01a56f-4c41-4938-aa34-bc20f9a038eb"></span><script>var element = document.getElementById("moose-equation-9c01a56f-4c41-4938-aa34-bc20f9a038eb");katex.render("     P_{iK}=J\\sigma_{ij}F_{Kj}^{-1}", element, {displayMode:true,throwOnError:false});</script></span> and so it is possible to convert a &quot;native&quot; Cauchy stress constitutive model to the 1st Piola-Kirchhoff stress and vice versa.</p><p><em>If the boundary conditions, body force, and constitutive model are all identical then the updated and total Lagrangian formulations will return exactly the same results.  There is no difference in the final results when using a <a href="../../source/kernels/lagrangian/UpdatedLagrangianStressDivergence.html">updated Lagrangian</a> or <a href="../../source/kernels/lagrangian/TotalLagrangianStressDivergence.html">total Lagrangian</a> model.</em></p><p>However, at times one formulation may be more convenient than another. For example, the <a href="Homogenization.html">homogenization system</a> system only works with the <a href="../../source/kernels/lagrangian/TotalLagrangianStressDivergence.html">total Lagrangian kernel</a> because of the difficulty in including the extra homogenization field in the kinematic spatial derivatives. In theory it can be more efficient to couple a &quot;native&quot; Cauchy stress constitutive model to the updated Lagrangian configuration and a &quot;native&quot; 1st Piola-Kirchhoff model to the total Lagrangian configuration. However, the currently-implemented <a href="NewMaterialSystem.html">material system</a> always coverts Cauchy stress to 1st Piola-Kirchhoff stress and vice-versa so that models can be used with either the updated or total Lagrangian kernels.</p><p>Both of these models degenerate to the same formulation for small kinematic theory: <span class="moose-katex-block-equation"><span class="moose-katex-equation table-cell" id="moose-equation-c317b568-1bee-40b6-973b-6752d9a78189"></span><script>var element = document.getElementById("moose-equation-c317b568-1bee-40b6-973b-6752d9a78189");katex.render("      \\begin{align*}       s_{ij,j}+b_{i} & = & 0 & \\, \\mathrm{{on}\\, \\Omega}\\\\       s_{ij}n_{j} & = & \\, \\hat{t}_{i} & \\mathrm{on}\\, \\partial\\Omega_{n}\\\\       u_{i} & = & \\hat{u}_{i} & \\, \\mathrm{on}\\, \\partial\\Omega_{e}       \\end{align*}", element, {displayMode:true,throwOnError:false});</script></span> where <span class="moose-katex-inline-equation" id="moose-equation-9c6a9027-8393-4923-bcbe-0d1dc56a8fdb"><script>var element = document.getElementById("moose-equation-9c6a9027-8393-4923-bcbe-0d1dc56a8fdb");katex.render("s_{ij}", element, {displayMode:false,throwOnError:false});</script></span> is the small (engineering) stress and there is now no difference between the current and reference configurations. Both the updated and total kernels both both large and small deformation theories.  The user can switch between them by setting the <code>large_kinematics</code> flag to <code>true</code> for large deformation theory and <code>false</code> for small deformation theory.  This flag applies to the kernels, the <a href="../../source/materials/lagrangian/ComputeLagrangianStrain.html">strain calculator</a>, the <a href="Homogenization.html">homogenization system</a>, and for many models, the <a href="NewMaterialSystem.html">constiutive</a> models for calculating the stress.  As such, it is often convenient to set it in the <code>GlobalParams</code> section  of the input file so that you can easily switch between the two.</p></section><section id="b666031a-71be-4336-9fdc-4183b9379e69" data-section-level="2" data-section-text="The Flag use_displaced_mesh"><h2 id="the-flag">The <code>use_displaced_mesh</code> Flag</h2><p>In MOOSE the <code>use_displaced_mesh</code> flag indicates whether gradients and integrals are with respect to the current (<code>true</code>) or reference (<code>false</code>) configurations.  With the new Lagrangian the only object that needs to have <code>use_displaced_mesh</code> set is the <a href="../../source/kernels/lagrangian/UpdatedLagrangianStressDivergence.html">updated Lagrangian</a> when <code>large_kinematics = true</code>.  The kernel enforces this condition with an error.  For all other objects in the new mechanics system the flag should be set to <code>false</code>.</p><p>The <a href="../../syntax/Modules/TensorMechanics/Master/index.html">TensorMechanics/MasterAction</a> can be used to easily coordinate the values of this flag and the <code>use_displaced_mesh</code> flag.</p></section><section id="1d68c06b-09c7-46cd-ad38-cb8e53941797" data-section-level="2" data-section-text="Coupling to the Lagrangian kernels"><h2 id="coupling-to-the-lagrangian-kernels">Coupling to the Lagrangian kernels</h2><p>Modules expecting to couple to the <code>stress</code> material property,  which represented the Cauchy stress in the old material system,  should now couple to <code>cauchy_stress</code> or <code>pk1_stress</code> instead. </p></section></section></div></div></div></main></div></body><script type="text/javascript" src="../../contrib/materialize/materialize.min.js"></script><script type="text/javascript" src="../../contrib/clipboard/clipboard.min.js"></script><script type="text/javascript" src="../../contrib/prism/prism.min.js"></script><script type="text/javascript" src="../../js/init.js"></script><script type="text/javascript" src="../../js/navigation.js"></script><script type="text/javascript" src="../../contrib/fuse/fuse.min.js"></script><script type="text/javascript" src="../../js/search_index.js"></script><script type="text/javascript" src="../../js/sqa_moose.js"></script>